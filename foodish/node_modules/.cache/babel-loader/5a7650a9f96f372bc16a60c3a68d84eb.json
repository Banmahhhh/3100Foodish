{"remainingRequest":"/Users/li/Desktop/foodish/node_modules/babel-loader/lib/index.js!/Users/li/Desktop/foodish/node_modules/eslint-loader/index.js??ref--13-0!/Users/li/Desktop/foodish/src/utils/request.js","dependencies":[{"path":"/Users/li/Desktop/foodish/src/utils/request.js","mtime":1548761534000},{"path":"/Users/li/Desktop/foodish/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/li/Desktop/foodish/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/li/Desktop/foodish/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/li/Desktop/foodish/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport axios from \"axios\";\nvar requst = axios.create({});\nrequst.interceptors.request.use(\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee(config) {\n    var token;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            config.headers = config.headers || {};\n            token = '';\n\n            try {\n              token = JSON.parse(window.localStorage.getItem('users')) || {};\n              token = token.token;\n            } catch (error) {}\n\n            config.headers['Authorization'] = \"Token \".concat(token);\n            return _context.abrupt(\"return\", config);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}());\nrequst.interceptors.response.use(function (response) {\n  return response;\n}, function (error) {\n  try {\n    if (error.response.data.detail === 'Signature has expired.') {\n      window.localStorage.setItem('users', \"\");\n      window.location.href = '/';\n    }\n  } catch (error) {}\n\n  return response;\n});\nexport default requst;",{"version":3,"sources":["/Users/li/Desktop/foodish/src/utils/request.js"],"names":["axios","requst","create","interceptors","request","use","config","headers","token","JSON","parse","window","localStorage","getItem","error","response","data","detail","setItem","location","href"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,IAAMC,MAAM,GAAGD,KAAK,CAACE,MAAN,CAAa,EAAb,CAAf;AACAD,MAAM,CAACE,YAAP,CAAoBC,OAApB,CAA4BC,GAA5B;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAgC,iBAAMC,MAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAC9BA,YAAAA,MAAM,CAACC,OAAP,GAAiBD,MAAM,CAACC,OAAP,IAAkB,EAAnC;AACIC,YAAAA,KAF0B,GAElB,EAFkB;;AAG9B,gBAAI;AACFA,cAAAA,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,CAAX,KAAoD,EAA5D;AACAL,cAAAA,KAAK,GAAGA,KAAK,CAACA,KAAd;AACD,aAHD,CAGE,OAAOM,KAAP,EAAc,CAEf;;AACDR,YAAAA,MAAM,CAACC,OAAP,CAAe,eAAf,oBAA2CC,KAA3C;AAT8B,6CAUvBF,MAVuB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhC;;AAAA;AAAA;AAAA;AAAA;AAaAL,MAAM,CAACE,YAAP,CAAoBY,QAApB,CAA6BV,GAA7B,CAAiC,UAAAU,QAAQ,EAAI;AAC3C,SAAOA,QAAP;AACD,CAFD,EAEG,UAAAD,KAAK,EAAI;AACV,MAAI;AACF,QAAIA,KAAK,CAACC,QAAN,CAAeC,IAAf,CAAoBC,MAApB,KAA+B,wBAAnC,EAA6D;AAC3DN,MAAAA,MAAM,CAACC,YAAP,CAAoBM,OAApB,CAA4B,OAA5B,EAAqC,EAArC;AACAP,MAAAA,MAAM,CAACQ,QAAP,CAAgBC,IAAhB,GAAuB,GAAvB;AACD;AACF,GALD,CAKE,OAAON,KAAP,EAAc,CAEf;;AACD,SAAOC,QAAP;AACD,CAZD;AAaA,eAAed,MAAf","sourcesContent":["import axios from \"axios\";\r\nconst requst = axios.create({});\r\nrequst.interceptors.request.use(async config => {\r\n  config.headers = config.headers || {}\r\n  let token = ''\r\n  try {\r\n    token = JSON.parse(window.localStorage.getItem('users')) || {}\r\n    token = token.token\r\n  } catch (error) {\r\n\r\n  }\r\n  config.headers['Authorization'] = `Token ${token}`\r\n  return config\r\n})\r\n\r\nrequst.interceptors.response.use(response => {\r\n  return response;\r\n}, error => {\r\n  try {\r\n    if (error.response.data.detail === 'Signature has expired.') {\r\n      window.localStorage.setItem('users', \"\");\r\n      window.location.href = '/'\r\n    }\r\n  } catch (error) {\r\n\r\n  }\r\n  return response;\r\n})\r\nexport default requst;\r\n"]}]}