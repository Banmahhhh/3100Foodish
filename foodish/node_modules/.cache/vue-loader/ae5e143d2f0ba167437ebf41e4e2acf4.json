{"remainingRequest":"/Users/li/Desktop/foodish/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/li/Desktop/foodish/src/views/post/index.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/li/Desktop/foodish/src/views/post/index.vue","mtime":1548770518000},{"path":"/Users/li/Desktop/foodish/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/li/Desktop/foodish/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/li/Desktop/foodish/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/li/Desktop/foodish/node_modules/less-loader/dist/cjs.js","mtime":1553691367000},{"path":"/Users/li/Desktop/foodish/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/li/Desktop/foodish/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n@import \"./style.less\";\r\n.text-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-family: \"PingFang SC\";\r\n}\r\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/post","sourcesContent":["<template>\r\n  <div class=\"post\">\r\n    <div class=\"post-header\">\r\n      <div class=\"post-left\" @click=\"$router.push({name:'Home'})\">\r\n        <img src=\"@/resource/fanhui.svg\" alt=\"\">\r\n      </div>\r\n      <span>Foodish</span>\r\n    </div>\r\n    <div class=\"post-main\">\r\n      <Form class=\"post-main-form\" :label-width=\"100\" ref=\"form\" :model=\"forms\" :rules=\"rules\">\r\n        <div class=\"post-main-left\">\r\n          <FormItem prop=\"image_url\" :label-width=\"0\">\r\n            <Upload :on-success=\"onFileSuccess\" name=\"img\" :show-upload-list=\"false\" multiple type=\"drag\" :action=\"API.IMAGE_UPLOAD\">\r\n              <div v-if=\"!forms.image_url\" style=\"padding: 120px 0\">\r\n                <Icon type=\"ios-cloud-upload\" size=\"52\" style=\"color: #3399ff\"></Icon>\r\n              </div>\r\n              <div v-else :style=\"`background:url(${forms.image_url}) no-repeat top center;\r\n                background-size: cover;width:100%;height:300px`\">\r\n              </div>\r\n            </Upload>\r\n          </FormItem>\r\n        </div>\r\n        <div class=\"post-main-right\">\r\n          <FormItem label=\"Food name\" prop=\"name\">\r\n            <Input type=\"text\" v-model=\"forms.name\" placeholder=\"\" style=\"width:450px\"></Input>\r\n          </FormItem>\r\n          <FormItem label=\"Price\" prop=\"price\">\r\n            <InputNumber v-model=\"forms.price\" :max=\"10000\" :min=\"1\" style=\"width:450px\"></InputNumber>\r\n          </FormItem>\r\n          <FormItem label=\"Date\" prop=\"date\">\r\n            <DatePicker :options=\"options\" v-model=\"forms.date\" type=\"datetime\" style=\"width:450px\"></DatePicker>\r\n          </FormItem>\r\n          <FormItem label=\"Place\" prop=\"place\">\r\n            <Input type=\"text\" v-model=\"forms.place\" style=\"width:450px\"></Input>\r\n          </FormItem>\r\n          <FormItem label=\"People\" prop=\"max_book\">\r\n            <InputNumber :max=\"10000\" v-model=\"forms.max_book\" :min=\"1\" style=\"width:450px\"></InputNumber>\r\n          </FormItem>\r\n        </div>\r\n        <div class=\"post-main-desc\">\r\n          <FormItem label=\"Desc\" prop=\"content\">\r\n            <Input type=\"textarea\" v-model=\"forms.content\" :rows=\"4\"></Input>\r\n          </FormItem>\r\n          <FormItem label=\"Flavor\" prop=\"flavor\">\r\n            <Tag @click.native=\"onTagSelect('flavor',item.val)\" :color=\"getIsActive('flavor',item.val,flavorList)\" v-for=\"item in flavorList\" :key=\"item.val\">{{item.text}}</Tag>\r\n          </FormItem>\r\n          <FormItem label=\"Pay attention\" prop=\"dislike\">\r\n            <Tag @click.native=\"onTagSelect('dislike',item.val)\" :color=\"getIsActive('dislike',item.val,dislikeList)\" v-for=\"item in dislikeList\" :key=\"item.val\">{{item.text}}</Tag>\r\n          </FormItem>\r\n          <FormItem>\r\n            <Button @click=\"submit\" long size=\"large\" type=\"warning\">Submit</Button>\r\n          </FormItem>\r\n        </div>\r\n      </Form>\r\n    </div>\r\n    <div class=\"text-modal\" v-if=\"isShow\">\r\n      <span style=\"color:#f95;font-size:100px\">Weell Done!</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as Rules from \"@/utils/validate\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      isShow: false,\r\n      forms: {\r\n        image_url: \"\",\r\n        name: \"\", //菜品名字\r\n        price: 0, //价格\r\n        place: \"\",\r\n        date: \"\",\r\n        max_book: 0, //最大预定数量\r\n        content: \"\", //简介\r\n        book_now: \"\", //当前预定数量\r\n        diet: \"\", //忌口类型\r\n        style: \"\", //菜品口味类型\r\n        author: \"\" //创建的作者\r\n      },\r\n      flavor: [],\r\n      dislike: [],\r\n      rules: {\r\n        image_url: Rules.required(\"the is required\"),\r\n        name: Rules.required(\"the is required\"),\r\n        price: Rules.number(\"the is required\", {\r\n          min: 1\r\n        }),\r\n        place: Rules.required(\"the is required\"),\r\n        date: {\r\n          type: \"date\",\r\n          required: true,\r\n          message: \"the is required\",\r\n          trigger: \"change\"\r\n        },\r\n        max_book: Rules.number(\"the is required\", {\r\n          min: 1\r\n        }),\r\n        content: Rules.required(\"the is required\")\r\n      },\r\n      flavorList: [],\r\n      dislikeList: [],\r\n      options: {\r\n        disabledDate(date) {\r\n          return (\r\n            date && date.valueOf() <= new Date().valueOf() + 24 * 60 * 60 * 1000\r\n          );\r\n        }\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n    this.flavorList = this.$utils.flavor;\r\n    this.dislikeList = this.$utils.dislike;\r\n  },\r\n  methods: {\r\n    getIsActive(type, val, list) {\r\n      const v = this[type].find(item => {\r\n        return item === val;\r\n      });\r\n      return v ? \"primary\" : \"blue\";\r\n    },\r\n    onTagSelect(type, val) {\r\n      const list = this[type];\r\n      const v = list.find(item => {\r\n        return item === val;\r\n      });\r\n      if (v) {\r\n        this[type] = list.filter(item => {\r\n          return item !== val;\r\n        });\r\n      } else {\r\n        this[type].push(val);\r\n      }\r\n    },\r\n    async submit() {\r\n      const result = await this.$refs.form.validate();\r\n      if (!result) return;\r\n      try {\r\n        const { data } = await this.$http({\r\n          url: this.API.FOOD,\r\n          method: \"post\",\r\n          data: this.getParams()\r\n        });\r\n        this.isShow = true;\r\n        setTimeout(() => {\r\n          this.$router.replace({ name: \"Home\" });\r\n        }, 2000);\r\n      } catch (error) {\r\n        this.$Message.error(\"error\");\r\n      }\r\n    },\r\n    async onFileSuccess(res) {\r\n      this.forms.image_url = res.url;\r\n    },\r\n    getParams() {\r\n      let author = \"\";\r\n      try {\r\n        author = this.$store.state.users.id;\r\n      } catch (error) {}\r\n      return {\r\n        ...this.forms,\r\n        book_now: 0,\r\n        date: +new Date(this.forms.date),\r\n        price: this.forms.price * 100,\r\n        diet: this.dislike.join(\",\"),\r\n        style: this.flavor.join(\",\"),\r\n        author\r\n      };\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n@import \"./style.less\";\r\n.text-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-family: \"PingFang SC\";\r\n}\r\n</style>\r\n"]}]}